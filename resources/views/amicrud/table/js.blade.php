<script>

function fetchData(t){let e={};var a=$(".search").val();a&&(e.search=a);var o=$("#paginated-number").val();o&&(e.paginated_number=o);a=$("#fromDate").val(),o=$("#toDate").val();a&&(e.from_date=a),o&&(e.to_date=o),$.ajax({url:t,data:e,type:"GET",success:function(e){$("#table-data").html("").html(e.data),$("#other-data").html("").html(e.other_data),$("#exportGroup .dropdown-menu a").each(function(){var t=$(this).data("export-type");$(this).attr("href",e.export_url+"&export-type="+t)})},error:function(t){console.log(t.responseText)}})}function DeleteRecord(t,e){$.ajax({type:"DELETE",url:t,data:{_token:e},timeout:6e4,datatype:"json",cache:!1,error:function(t,e,a){btn.prop("disabled",!1),$(".spin-loader").fadeOut();var o=xhr.responseJSON.errors,o=Object.values(o)[0];$(".process-response").html("").html(o,"error")},success:function(t){Swal.fire({title:html_to_text(t.message),icon:t.status,confirmButtonText:"Close"}),t.list_target&&t.list_target_route&&fetchData(t.list_target_route)}})}function html_to_text(t){var e=$("<div/>");return e.html(t),e.find("button.close").remove(),e.text()}$(document).ready(function(){var a=$('meta[name="csrf-token"]').attr("content"),t=$("#table-data").attr("data-list_target_route");t&&fetchData(t),$(document).on("input",".category-checkbox, .warehouse-checkbox, .factory-checkbox, .customer_type-checkbox, .expenditure_type-checkbox, .branch-checkbox, .search",function(){fetchData(t)}),$(document).on("change",".range_date, #paginated-number",function(){fetchData(t)}),$(document).on("input",".search-sidebar",function(){var t=$(this).attr("data-target"),e=$(this).val(),a=$(this).attr("data-type");fetchSideBarData(e,t,a)}),$(document).on("click",".cancel_btn",function(){fetchData(t)}),$(document).on("click",".edit-item-btn",function(){var t=$(this).closest("tr").attr("data-id"),e=$(this).attr("data-url"),o=($(this).attr("data-name"),"#table-data");t&&$.ajax({type:"GET",url:e,timeout:6e4,datatype:"json",cache:!1,beforeSend:function(t){$(o).html('<i class="fa fa-spinner fa-spin" style="font-size:24px"></i>')},error:function(t,e,a){$(o).html("")},success:function(t){$(o).html("").html(t);$(o).find("form");$(o).find(".dropify").each(function(){$(this).dropify()}),$(o).find(".summernote").each(function(){$(this).summernote()})}})}),$(document).on("click",".add-btn",function(){var t=$(this).attr("data-url"),o=($(this).attr("data-name"),"#table-data");$.ajax({type:"GET",url:t,timeout:6e4,datatype:"json",cache:!1,beforeSend:function(t){$(o).html('<i class="fa fa-spinner fa-spin" style="font-size:24px"></i>')},error:function(t,e,a){$(o).html("")},success:function(t){$(o).html("").html(t);$(o).find("form");$(o).find(".dropify").each(function(){$(this).dropify()}),$(o).find(".summernote").each(function(){$(this).summernote()})}})}),$(document).on("click",".save_btn",function(t){t.preventDefault();const n=$(this);n.prop("disabled",!0);let e=n.closest("form");var a=new FormData(e[0]),o=e.attr("action"),t=e.attr("method");n.append('<span class="spin-loader"> <i class="fa fa-spinner fa-spin"></i> please wait...</span>'),$.ajax({type:t,url:o,data:a,cache:!1,contentType:!1,processData:!1,error:function(t,e,a){n.prop("disabled",!1),$(".spin-loader").fadeOut();var o=t.responseJSON.errors;if(o){for(control in o)$(".error-response."+control).html("<code>"+o[control][0]+"</code>");setTimeout(function(){$(".error-response").html("")},3e3)}else Swal.fire({title:html_to_text(a),icon:"error",confirmButtonText:"Close"})},success:function(t){n.prop("disabled",!1),$(".spin-loader").fadeOut(),Swal.fire({title:html_to_text(t.message),icon:t.status,confirmButtonText:"Close"}),$("#showModal").modal("hide"),t.list_target&&t.list_target_route&&fetchData(t.list_target_route),t.reload&&setTimeout(function(){window.location.reload()},2e3)}})}),$(document).on("click",".remove-item-btn",function(){var e=$(this).attr("data-url"),t=$(this).attr("data-name");Swal.fire({title:"Are you sure you want to delete "+t+" ?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&DeleteRecord(e,a)})}),$(document).on("click","a.page-link",function(t){t.preventDefault();t=$(this).attr("href");$.ajax({url:t,type:"GET",success:function(t){$("#table-data").html("").html(t.data)},error:function(t){console.log(t.responseText)}})})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("exportGroup"),a=e.querySelector(".dropdown-menu");e.querySelector(".dropdown-toggle").addEventListener("click",function(){a.classList.toggle("show")}),document.addEventListener("click",function(t){e.contains(t.target)||a.classList.remove("show")})});

</script>